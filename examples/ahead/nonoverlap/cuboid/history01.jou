#!python
cubit.cmd('${side = 1.0}')
cubit.cmd('${height = 1.5}')
cubit.cmd('${overlap_vol_frac = 0.0}')
cubit.cmd('${h_fine = 0.25}')
cubit.cmd('${h_coarse = 0.50}')
cubit.cmd('${area = side * side}')
cubit.cmd('${volume = area * height}')
cubit.cmd('${overlap_volume = overlap_vol_frac * volume}')
cubit.cmd('${overlap_length = overlap_volume / area}')
cubit.cmd('${domain_height = (height + overlap_length) / 2.0}')
cubit.cmd('${offset = abs(domain_height - overlap_length) / 2.0}')
cubit.cmd('create brick x {side} y {side} z {domain_height}')
cubit.cmd('move volume 1 z {-offset} include_merged')
cubit.cmd('#volume 1 scheme tetmesh')
cubit.cmd('volume 1 size {h_fine}')
cubit.cmd('mesh volume 1')
cubit.cmd('block 1 volume 1')
cubit.cmd('#block 1 element type tetra4')
cubit.cmd('block 1 name "fine"')
cubit.cmd('nodeset 1 surface 4')
cubit.cmd('nodeset 1 name "nsx-"')
cubit.cmd('nodeset 2 surface 6')
cubit.cmd('nodeset 2 name "nsx+"')
cubit.cmd('nodeset 3 surface 3')
cubit.cmd('nodeset 3 name "nsy-"')
cubit.cmd('nodeset 4 surface 5')
cubit.cmd('nodeset 4 name "nsy+"')
cubit.cmd('nodeset 5 surface 2')
cubit.cmd('nodeset 5 name "nsz-"')
cubit.cmd('nodeset 6 surface 1')
cubit.cmd('nodeset 6 name "nsz+"')
cubit.cmd('sideset 1 surface 4')
cubit.cmd('sideset 1 name "ssx-"')
cubit.cmd('sideset 2 surface 6')
cubit.cmd('sideset 2 name "ssx+"')
cubit.cmd('sideset 3 surface 3')
cubit.cmd('sideset 3 name "ssy-"')
cubit.cmd('sideset 4 surface 5')
cubit.cmd('sideset 4 name "ssy+"')
cubit.cmd('sideset 5 surface 2')
cubit.cmd('sideset 5 name "ssz-"')
cubit.cmd('sideset 6 surface 1')
cubit.cmd('sideset 6 name "ssz+"')
cubit.cmd('set large exodus file off')
cubit.cmd('export mesh "cuboid-1.g" overwrite')
cubit.cmd('delete mesh')
cubit.cmd('move volume 1 z {2 * offset} include_merged')
cubit.cmd('#volume 1 scheme tetmesh')
cubit.cmd('volume 1 size {h_coarse}')
cubit.cmd('mesh volume 1')
cubit.cmd('block 1 volume 1')
cubit.cmd('#block 1 element type tetra4')
cubit.cmd('block 1 name "coarse"')
cubit.cmd('nodeset 1 surface 4')
cubit.cmd('nodeset 1 name "nsx-"')
cubit.cmd('nodeset 2 surface 6')
cubit.cmd('nodeset 2 name "nsx+"')
cubit.cmd('nodeset 3 surface 3')
cubit.cmd('nodeset 3 name "nsy-"')
cubit.cmd('nodeset 4 surface 5')
cubit.cmd('nodeset 4 name "nsy+"')
cubit.cmd('nodeset 5 surface 2')
cubit.cmd('nodeset 5 name "nsz-"')
cubit.cmd('nodeset 6 surface 1')
cubit.cmd('nodeset 6 name "nsz+"')
cubit.cmd('sideset 1 surface 4')
cubit.cmd('sideset 1 name "ssx-"')
cubit.cmd('sideset 2 surface 6')
cubit.cmd('sideset 2 name "ssx+"')
cubit.cmd('sideset 3 surface 3')
cubit.cmd('sideset 3 name "ssy-"')
cubit.cmd('sideset 4 surface 5')
cubit.cmd('sideset 4 name "ssy+"')
cubit.cmd('sideset 5 surface 2')
cubit.cmd('sideset 5 name "ssz-"')
cubit.cmd('sideset 6 surface 1')
cubit.cmd('sideset 6 name "ssz+"')
cubit.cmd('set large exodus file off')
cubit.cmd('export mesh "cuboid-2.g" overwrite')
